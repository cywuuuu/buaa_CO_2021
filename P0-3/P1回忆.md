# 2021年P1课上评测回忆


### 2020级的复盘

# L1_奇校验与偶校验

- 一个比较简单的组合逻辑。但有一点需要注意：由于用最高位来调整奇偶性，在算1的个数的时候是**不包括最高位**的（不管最高位是0还是1），我就因为这点第一次提交WA了……
- 在算1的个数方面，个人觉得最好用的就是异或（“^”）了。**异或运算在1的个数为奇数时为1，在个数为偶数时为0**，根据这个特点我们可以一步直接写出最高位的表达式：（忘了输出用啥表示，先暂时用out表示）

```
assign out[31] = (^data[30:0]) ^ check;
```

# L2_心情电路

- 题干已经非常清楚地说明了状态转移了，我们只需要用代码把它实现就好。注意sad到clueless的2周期计数与busy和clueless到asleep的3周期计数的复位，以及**异步复位要将posedge reset写入always的敏感信号中**即可。
- 这道题主要是题干冗长（让我想起了小学的应用题……），但边读题边画状态转移图，之后再照着图coding就会简单很多（所以考试要拿足草稿纸啊）。

# L3_方程式匹配

- 考场上想的就是简单粗暴地罗列状态：初始态，等号左边字母/数字，等号左边运算符，等号，等号右边字母/数字，等号右边运算符，以及不匹配输入。状态转移就不赘述了，然后在等号右边字母/数字状态输出1。最后注意异步复位和**空格输入直接跳过状态转移**就行。
- 然后助教问答的时候给我说用两个状态机比用一个要省状态，再加上自己确实打了很多重复的代码，于是陷入思考……目前想的是改成初始态/运算符、字母/数字、不匹配输入三种状态，同时设置存储等号的状态机，在字母/数字状态且出现过一次等号的时输出1。还有更简单的方法欢迎分享哈。
- 另外助教问答时提到怎么查看中间变量（例如这道题中的status），我表示从来没用过，都是波形错了直接改主代码或者提交结果错了直接改调试用的数据（助教：好家伙）。这里还是记一下吧：ISim界面最左边一栏第一行展开，下面有一个uut，单击就可以在旁边一栏中看到中间变量啦。

# 附加题：补全代码

- 大胆假设，小心验证！
- 把波形的in和out一一对应写在草稿纸上，然后写出每一步转移的状态，空出来的状态一个一个试就能试出来。

陆柏宏 20231198 (学生) 回复: 田笑滢 20375190 (学生)

原来第一题只要一行吗，我还傻傻地分类讨论（虽然也对了）

```verilog
always @(*) begin
    case(check)
        1: if(^data) msb = data[31];
           else msb = ~data[31];
        0: if(^data) msb = ^data[31];
           else msb = data[31];
    endcase
end

assign result = {msb, data[30:0]};
```